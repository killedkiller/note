方法1.双写
切一个时间点 切一个idx
然后开始灌入此id之前的数据
然后重写逻辑
增加操作:写两表，
更新操作:旧表一样写新表,新表记录存在写新表
删除操作：旧表一样写新表,新表记录存在则删除
到idx之前的旧数据全部灌入

方法2:快照
在某个时间t0,
停某个从库，（保证数据一致性）
把它的数据全部取出并生成新数据
从时间点t0开始，把现在的增删改等写操作生成新数据结构下的sql
用消息队列写入一个文件filea。
并在t0时间造的数据完全生成好后，
执行存量的filea里的sql，
执行完后，停服，将新逻辑上线

方法3.停服

之后切小流量读新表，看有没有错误